# Debug

1. Run the local plugin code with your debugging IDE of choice with something similar to `go run ./... -debug`.
2. Set breakpoints in your IDE.
3. In your shell, apply the resource you are working on.
   ```bash
   # export the printed environment variable from the go run ./... -debug command above. E.g.
   export TF_REATTACH_PROVIDERS='{"registry.terraform.io/zitadel/zitadel":{"Protocol":"grpc","ProtocolVersion":6,"Pid":8123,"Test":true,"Addr":{"Network":"unix","String":"/tmp/plugin275634719"}}}'

   # go to a directory containing .tf files.
   cd /my-zitadel-terraform-files

   # apply them
   terraform apply
   ```
4. The execution stops at your breakpoints.

# Run Acceptance Tests

Run a local ZITADEL instance using docker compose.

```bash
# To have the machine key written with the correct ownership, set your current users ID.
export TF_ZITADEL_UID="$(id -u)"

# Pull Images
docker compose --file ./acceptance/docker-compose.yaml pull

# Setup ZITADEL
docker compose --file ./acceptance/docker-compose.yaml run wait_for_zitadel
```

Run the accepance tests using the machine key generated by ZITADEL.

```bash
TF_ACC=1 TF_ACC_ZITADEL_TOKEN=$(pwd)/acceptance/machinekey/zitadel-admin-sa.json go test ./...
```

# Generate Docs

1. Manually maintain files in /templates and /examples
1. Install the tool tfplugindocs with `go install github.com/hashicorp/terraform-plugin-docs/cmd/tfplugindocs`
1. Generate the docs with `tfplugindocs generate`
